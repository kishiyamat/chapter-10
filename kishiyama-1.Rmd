---
title: "Generalized Linear Model"
author: "Takeshi Kishiyama"
date: '`r format(Sys.time(), "%Y/%m/%d %H:%M")`'
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    message = FALSE,
    cache = FALSE,
    warning = FALSE,
    width=6,
    fig.align='center',
    fig.pos='H',
    dev = c("png", "svg")
)
# knitr::opts_chunk$set(echo=FALSE)
library(DiagrammeR)
library(tidyverse)
library(lubridate)
library(magrittr)
library(ggplot2)
library(DT)
library(rmarkdown)
'%r+%' <- function(a,b) rbind(a,b)
library("dplyr")
library("stringr")
```

# R入門<br>（関数型っぽく）

## 今日のテーマ

* R入門（関数型っぽく）
* 8章と9章
* 10章
    
## 今日のテーマ

* **R入門（関数型っぽく）**
* 8章と9章
* 10章

```{r}
set.seed(1)
```
 
## R入門

* 関数と型、ベクトル
* 確率密度関数、尤度、パラメター
* 最尤推定

## **関数**と型、ベクトル

確率密度関数って言ってるけど、そもそも**関数**ってなんだっけ？

* 「もらった要素（引数）に手を加えてから返すもの」です。
    
```{r}
factorial(5)
my.f <- function(x){
    x + 2
}
my.f(4)
```

## 関数と**型**、ベクトル

なら「型」ってなんですか？

* 文字型とか数字型とか色々あります。
* 関数の引数は特定の型しか受けつない場合があります。
    
```{r}
class("猫")
class(2)
# exp("猫")
# Error in exp("猫") : non-numeric argument to mathematical function
```


## 関数と型、**ベクトル**

関数と型は分かったｊけど、「ベクトル」は？

* 全要素の型が同型と保証されています(atomic vecotr)。
* その型を引数にとる関数を全要素に適用(apply)できます！

```{r}
X <- 1:10
factorial(X)
my.f(X)
# sapply(X, my.f)
```

## 関数と型、ベクトルのまとめ

ここまでのまとめ

* 引数をとって操作を行ない結果を返す
* データには型があり、関数の引数には型の制限がある
* 同型である atomic vecotr には関数を apply できます。

えっと、じゃあ確率密度関数ってなに？

## **確率密度関数**、パラメター、尤度

**確率密度関数** は任意の値をとって確率を返します...？
 
* 餌をばらまいたときに集まってくる猫の数
* 4匹集まる確率や10匹あつまる確率を返してくれる。

```{r, fig.height=3}
x <- 0:10  # 0から10までの値のベクトル
p <- dpois(lambda=4, x)  # 「それぞれが起こりうる確率」のベクトル
plot(p~x, type="b", main="平均4のポワソン分布")
```


## 確率密度関数、**パラメター**、尤度

値が起きる確率を説明する2つのアプローチ

* 0匹の確率、1匹の確率、とすべての条件で調べる
* 確率密度関数の **パラメター** を調べる $\gets$ こっちで進める

```{r, fig.height=3}
layout(matrix(1:2, ncol=2))
plot(p~x, type="b", main="平均4のポワソン分布")
p.lambda.8 <- dpois(lambda=8, x)  # もしパラメターが8だったら？
plot(p.lambda.8~x, type="b", main="平均8のポワソン分布")
```

## 確率密度関数、パラメター、**尤度**

１００回の測定結果(`Y <- rpois(100, 4.3)`)と比べてどっちが高い？

1. hist(Y)が左の分布から起こる確率
1. hist(Y)が右の分布から起こる確率
    
```{r, fig.height=2}
Y <- rpois(100, 4.3)
layout(matrix(1:3, ncol=3)) 
plot(p~x, type="b", main="平均4のポワソン分布")
hist(Y)
plot(p.lambda.8~x, type="b", main="平均8のポワソン分布")
```

* $f(x)=\frac{\lambda^{x}e^{-

## 最尤推定

