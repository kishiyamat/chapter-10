---
title: "chapter-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
d <- read.csv("http://hosho.ees.hokudai.ac.jp/~kubo/stat/2015/Fig/poisson/data3a.csv")
d
```
```{r}
d
fit <- glm(y ~ x, data = d, family = poisson)
fit
```

パラメターの最適化

```{r}
Y <- rpois(100, 3.6)
hist(Y)
```

パラメターの最適化をRでしてみる。
dpois returns probability.

```{r}
LL <- function(x) return(sum(dpois(Y, x[1], log = TRUE)))
# LL <- function (x) return(sum(NB(x[1],x[2])*d)) # 目的関数(対数尤度を計算する関数)
optim(c(2), LL, control=list(fnscale=-1)) # 初期パラメータ (0.2, 0.5) で最大化実行
```

1. function
2. theory
3. graph

again
これは単純な線
you might want to know what "vector" means


```{r}
# function y
f.y <- function(x){
    b_0 <- 0
    b_1 <- 1
    e <- rnorm(1, mean=0, sd=1)
    y <- b_0 + b_1 * x + e
    return(y)
}

# X_1=1, X_2=1.1, X_3=1.2, ...
X <- seq(1, 10, 0.1)

Y <- sapply(X, f.y)
# Y <- y(X)
plot(X, Y)
```

このグラフから傾きと切片を知りたい。
Which of values do we need so that we can get the best parameters?


```{r}
lm(Y~X)
```


how can get these values?

```{r}
# function y
L <- function(parameters){
    b0 <- parameters[1]
    b1 <- parameters[2]
    LL <- sum((Y-(b0 + b1*X))**2)
} 

optim(c(0,0), L) # 初期パラメータ (0.2, 0.5) で最大化実行
```

